(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const m of c.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&a(m)}).observe(document,{childList:!0,subtree:!0});function n(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(l){if(l.ep)return;l.ep=!0;const c=n(l);fetch(l.href,c)}})();let s=null;const z=document.getElementById("urlInput"),b=document.getElementById("extractBtn"),E=document.getElementById("previewFrame"),ae=document.getElementById("controlsPanel"),de=document.getElementById("placeholderState"),r=document.getElementById("statusIndicator"),se=document.getElementById("injectBundleBtn"),ce=document.getElementById("removeIconsCheck"),I=document.getElementById("injectLogoBtn"),ie=document.getElementById("refreshBtn"),F=document.getElementById("logoInput"),U=document.getElementById("themeToggleBtn"),h=document.getElementById("deployNetlifyBtn"),x=document.getElementById("netlifyTokenInput"),v=document.getElementById("deployStatus"),ue=document.getElementById("buttonTargetSelect"),me=document.getElementById("redirectDestinationSelect"),q=document.getElementById("applyRedirectBtn"),u=document.getElementById("redirectStatus"),w=document.getElementById("bundleBuilder"),ge=document.getElementById("bundleBackBtn"),ye=document.getElementById("bundleSaveBtn"),L=document.getElementById("bundleSubmitBtn"),fe=document.getElementById("bundleImageInput"),d=document.getElementById("bundlePreview"),be=document.getElementById("bundleDraftStatus"),J=document.getElementById("themeToggleBtnBundle"),pe=document.getElementById("bundleAddCardBtn"),ve=document.getElementById("bundleRemoveCardBtn"),Be=document.getElementById("bundleAddImageBtn"),Ee=document.getElementById("bundleRemoveImageBtn"),T=document.getElementById("bundleBgColor"),N=document.getElementById("bundleBgColorText"),_=document.getElementById("bundlePrimaryFont"),G=document.getElementById("bundleHeadingSize"),A=document.getElementById("bundleHeadingColor"),M=document.getElementById("bundleHeadingColorText"),k=document.getElementById("bundleAccentColor"),O=document.getElementById("bundleAccentColorText"),D=document.getElementById("bundleButtonColor"),R=document.getElementById("bundleButtonColorText"),P=document.getElementById("bundleTextColor"),j=document.getElementById("bundleTextColorText"),W=document.getElementById("bundleBodySize"),K=document.getElementById("bundleBorderRadius"),Y=document.getElementById("bundlePadding"),he=document.getElementById("bundleApplyStyleBtn"),Se=document.getElementById("bundleResetStyleBtn");let p=null,H=null,B=null,y=null,$=null,S=null;const X="shopifyforger-theme",i=window.location.origin;async function Q(){const e=z.value.trim();if(!e){alert("Please enter a URL");return}r.textContent="Extracting...",r.classList.add("loading"),b.disabled=!0,b.textContent="Extracting...";try{const n=await(await fetch(`${i}/api/extract`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e})})).json();if(!n.success)throw new Error(n.error||"Extraction failed");s=n.websiteName,E.src=`${i}/preview/${s}/index.html`,Re(),r.textContent="Active",r.classList.remove("loading"),b.disabled=!1,b.innerHTML='<span class="icon">âš¡</span> Extract Front-end',de.classList.add("hidden"),ae.classList.remove("hidden"),console.log("Website extracted:",n)}catch(t){console.error(t),r.textContent="Error",r.classList.remove("loading"),b.disabled=!1,b.innerHTML='<span class="icon">âš¡</span> Extract Front-end',alert(`Extraction failed: ${t.message}`)}}async function xe(e){if(!s){alert("Please extract a website first");return}r.textContent="Injecting Bundle...",r.classList.add("loading"),L.disabled=!0;try{const n=await(await fetch(`${i}/api/inject-bundle`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({websiteName:s,bundleHtml:e})})).json();if(!n.success)throw new Error(n.error||"Bundle injection failed");E.src=`${i}/preview/${s}/index.html?t=${Date.now()}`,r.textContent="Bundle injected",r.classList.remove("loading"),L.disabled=!1,console.log("Bundle injected:",n)}catch(t){console.error(t),r.textContent="Error",r.classList.remove("loading"),L.disabled=!1,alert(`Bundle injection failed: ${t.message}`)}}function Ce(){if(!s){alert("Please extract a website first");return}w.classList.remove("hidden"),w.setAttribute("aria-hidden","false"),p&&we(),Le()}function V(){w.classList.add("hidden"),w.setAttribute("aria-hidden","true"),B&&(clearInterval(B),B=null)}function Z(e){be.textContent=e,r.textContent=e,r.classList.remove("loading")}function Ie(e){if(!e)return;const t=new FileReader;t.onload=()=>{H=t.result,d.querySelectorAll("img.bundle-image").forEach(n=>{n.src=t.result})},t.readAsDataURL(e)}function Le(){B&&clearInterval(B);const e=new Date().getTime()+24*60*60*1e3;B=setInterval(()=>{const t=new Date().getTime(),n=e-t,a=Math.max(0,Math.floor(n%(1e3*60*60*24)/(1e3*60*60))),l=Math.max(0,Math.floor(n%(1e3*60*60)/(1e3*60))),c=Math.max(0,Math.floor(n%(1e3*60)/1e3)),m=d.querySelector("#hours"),g=d.querySelector("#minutes"),f=d.querySelector("#seconds");m&&(m.textContent=String(a).padStart(2,"0")),g&&(g.textContent=String(l).padStart(2,"0")),f&&(f.textContent=String(c).padStart(2,"0"))},1e3)}function ee(){p={html:d.innerHTML,image:H}}function we(){p.html&&(d.innerHTML=p.html),p.image&&(H=p.image,d.querySelectorAll("img.bundle-image").forEach(e=>{e.src=p.image})),y=null}function Te(e){const t=d.querySelector(".card");if(!t)return null;const n=t.cloneNode(!0);n.classList.remove("recommended"),n.style.border="1px solid #E0E0E0";const a=n.querySelector(".badge-red, .badge-gray");a&&(a.classList.remove("badge-red"),a.classList.add("badge-gray"),a.style.background="#EBEBEB",a.style.color="#000",a.textContent="PROMO"),Array.from(n.querySelectorAll('[contenteditable="true"]')).forEach(re=>{re.textContent=""});const c=n.querySelector('h3[contenteditable="true"]');c&&(c.textContent=`New Bundle ${e}`);const m=n.querySelector('.info p[contenteditable="true"]');m&&(m.innerHTML="Edit bundle subtitle");const g=n.querySelectorAll('.info p[contenteditable="true"]');g.length>=4&&(g[1].textContent="Total: Â£0.00",g[2].innerHTML="<del>Â£0.00</del>",g[3].textContent="Only Â£0.00 each");const f=n.querySelectorAll('.info p[contenteditable="true"]');f.length>=5&&(f[4].textContent="+ Free Shipping");const C=n.querySelector('button[contenteditable="true"]');C&&(C.textContent="GET 0% OFF");const o=n.querySelector('p[contenteditable="true"]');return o&&(o.textContent="180 Day Money Back Guarantee"),n}function Ae(){const e=d.querySelector(".pricing-grid"),t=e?e.querySelectorAll(".card").length+1:1,n=Te(t);!e||!n||e.appendChild(n)}function te(e){const t=d.querySelector(".pricing-grid");if(!(!t||!e)){if(t.querySelectorAll(".card").length<=1){alert("At least one bundle card is required.");return}e.remove(),y=null}}function ke(){if(!y){alert("Select a bundle card first.");return}const e=y.querySelector(".card-content > div");if(!e)return;const t=e.querySelector("img.bundle-image");if(!t)return;const n=t.cloneNode(!0);n.style.marginLeft="-35px",n.style.position="relative",n.style.zIndex=String(e.querySelectorAll("img.bundle-image").length+1),n.style.top=`-${10*e.querySelectorAll("img.bundle-image").length}px`,e.appendChild(n)}function De(){if(!y){alert("Select a bundle card first.");return}const e=y.querySelectorAll("img.bundle-image");if(e.length<=1){alert("At least one image is required.");return}e[e.length-1].remove()}function Pe(){ee(),Z("Bundle draft saved")}function $e(){ee();const e=d.outerHTML;Z("Sending bundle to backend..."),xe(e),V()}async function qe(){if(!s){alert("Please extract a website first");return}r.textContent="Removing Icons...",r.classList.add("loading");try{const t=await(await fetch(`${i}/api/remove-header-icons`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({websiteName:s})})).json();if(!t.success)throw new Error(t.error||"Icon removal failed");E.src=`${i}/preview/${s}/index.html?t=${Date.now()}`,r.textContent="Active",r.classList.remove("loading"),console.log("Icons removed:",t),alert(t.message)}catch(e){console.error(e),r.textContent="Error",r.classList.remove("loading"),alert(`Icon removal failed: ${e.message}`)}}function ne(){const e=T.value,t=_.value,n=G.value+"px",a=A.value,l=k.value,c=D.value,m=P.value,g=W.value+"px",f=K.value+"px",C=Y.value+"px 16px";d.style.backgroundColor=e,d.style.padding=C,d.querySelectorAll("h1, h2").forEach(o=>{o.style.fontFamily=t,o.style.fontSize=n,o.textContent.includes("Save")||o.textContent.includes("Protect")||o.style.color==="rgb(227, 45, 45)"?o.style.color=l:o.style.color=a}),d.querySelectorAll("p").forEach(o=>{o.closest("button")||(o.style.fontFamily=t,o.style.fontSize=g,o.style.color==="rgb(227, 45, 45)"||o.textContent.includes("Limited")||o.textContent.includes("Only")?o.style.color=l:o.style.color!=="rgb(153, 153, 153)"&&o.style.color!=="rgb(102, 102, 102)"&&(o.style.color=m))}),d.querySelectorAll(".card").forEach(o=>{o.style.borderRadius=f}),d.querySelectorAll("button.cta-btn").forEach(o=>{o.style.backgroundColor=c,o.style.fontFamily=t}),d.querySelectorAll(".timer-units span").forEach(o=>{(o.id==="hours"||o.id==="minutes"||o.id==="seconds")&&(o.style.color=l)}),d.querySelectorAll(".timer-section span").forEach(o=>{o.textContent.includes("Limited")&&(o.style.color=l)}),d.querySelectorAll(".badge-red").forEach(o=>{o.style.backgroundColor=l}),console.log("Bundle styles applied successfully")}function Fe(){T.value="#FFF7F6",N.value="#FFF7F6",_.value="Poppins, sans-serif",G.value="34",A.value="#000000",M.value="#000000",k.value="#E32D2D",O.value="#E32D2D",D.value="#1EB13A",R.value="#1EB13A",P.value="#000000",j.value="#000000",W.value="16",K.value="10",Y.value="64",ne()}async function Ne(){if(!s){alert("Please extract a website first");return}const e=F.files[0];if(!e){alert("Please select a logo file");return}r.textContent="Uploading Logo...",r.classList.add("loading"),I.disabled=!0;try{const t=new FormData;t.append("logo",e),t.append("websiteName",s);const a=await(await fetch(`${i}/api/inject-logo?websiteName=${encodeURIComponent(s)}`,{method:"POST",body:t})).json();if(!a.success)throw new Error(a.error||"Logo upload failed");E.src=`${i}/preview/${s}/index.html?t=${Date.now()}`,r.textContent="Active",r.classList.remove("loading"),I.disabled=!1,console.log("Logo uploaded:",a),alert(a.message)}catch(t){console.error(t),r.textContent="Error",r.classList.remove("loading"),I.disabled=!1,alert(`Logo upload failed: ${t.message}`)}}function Me(){s&&(E.src=`${i}/preview/${s}/index.html?t=${Date.now()}`)}async function Oe(){if(s)try{const t=await(await fetch(`${i}/api/site-status?websiteName=${encodeURIComponent(s)}`)).json();if(!t.success)return;if(S===null){S=t.lastModified;return}t.lastModified>S&&(S=t.lastModified,E.src=`${i}/preview/${s}/index.html?t=${Date.now()}`)}catch(e){console.warn("Live update check failed:",e)}}function Re(){$&&clearInterval($),S=null,$=setInterval(Oe,5e3)}function oe(e){document.body.setAttribute("data-theme",e);const t=e==="light"?"Dark Mode":"Light Mode";U.textContent=t,J.textContent=t,localStorage.setItem(X,e)}function le(){const e=document.body.getAttribute("data-theme")||"dark";oe(e==="dark"?"light":"dark")}b.addEventListener("click",Q);se.addEventListener("click",Ce);ce.addEventListener("change",e=>{e.target.checked&&qe()});I.addEventListener("click",()=>F.click());F.addEventListener("change",Ne);ie.addEventListener("click",Me);q.addEventListener("click",je);U.addEventListener("click",le);J.addEventListener("click",le);ge.addEventListener("click",()=>{V()});ye.addEventListener("click",()=>{Pe()});L.addEventListener("click",()=>{$e()});fe.addEventListener("change",e=>{Ie(e.target.files[0])});d.addEventListener("click",e=>{if(e.target.classList.contains("card-remove")){const n=e.target.closest(".card");te(n);return}const t=e.target.closest(".card");if(t&&t.closest("#bundlePreview")){d.querySelectorAll(".card").forEach(a=>{a.classList.remove("recommended"),a.style.border="1px solid #E0E0E0";const l=a.querySelector(".badge-red, .badge-gray");l&&(l.classList.remove("badge-red"),l.classList.add("badge-gray"),l.style.background="#EBEBEB",l.style.color="#000")}),t.classList.add("recommended"),t.style.border="2px solid #FC0000";const n=t.querySelector(".badge-gray, .badge-red");n&&(n.classList.remove("badge-gray"),n.classList.add("badge-red"),n.style.background="#FC0000",n.style.color="#fff"),y=t}});pe.addEventListener("click",()=>{Ae()});ve.addEventListener("click",()=>{if(!y){alert("Select a bundle card first.");return}te(y)});Be.addEventListener("click",()=>{ke()});Ee.addEventListener("click",()=>{De()});T.addEventListener("input",e=>{N.value=e.target.value});N.addEventListener("input",e=>{T.value=e.target.value});A.addEventListener("input",e=>{M.value=e.target.value});M.addEventListener("input",e=>{A.value=e.target.value});k.addEventListener("input",e=>{O.value=e.target.value});O.addEventListener("input",e=>{k.value=e.target.value});D.addEventListener("input",e=>{R.value=e.target.value});R.addEventListener("input",e=>{D.value=e.target.value});P.addEventListener("input",e=>{j.value=e.target.value});j.addEventListener("input",e=>{P.value=e.target.value});he.addEventListener("click",()=>{ne()});Se.addEventListener("click",()=>{Fe()});h.addEventListener("click",async()=>{await He()});z.addEventListener("keypress",e=>{e.key==="Enter"&&Q()});async function je(){const e=ue.value,t=me.value;if(!e){u.textContent="Please select a button to redirect",u.style.color="#dc2626";return}if(!t){u.textContent="Please select a destination",u.style.color="#dc2626";return}if(!s){u.textContent="Please extract a website first",u.style.color="#dc2626";return}try{q.disabled=!0,u.textContent="Applying redirect...",u.style.color="#6366f1";const a=await(await fetch(`${i}/api/apply-button-redirect`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({websiteName:s,buttonType:e,destination:t})})).json();if(a.success)u.textContent=`âœ“ Redirect applied: ${e} â†’ ${t}`,u.style.color="#16a34a",console.log("Button redirect applied successfully"),setTimeout(()=>reloadPreview(),500);else throw new Error(a.error||"Failed to apply redirect")}catch(n){console.error("Button redirect error:",n),u.textContent=`âœ— Error: ${n.message}`,u.style.color="#dc2626"}finally{q.disabled=!1}}async function He(){if(!s){alert("Please extract a website first");return}const e=x.value.trim();if(!e){alert("Please enter your Netlify Personal Access Token"),x.focus();return}v.textContent="Deploying to Netlify...",v.style.color="#666",h.disabled=!0,h.textContent="ðŸš€ Deploying...";try{const n=await(await fetch(`${i}/api/deploy-netlify`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({websiteName:s,netlifyToken:e})})).json();if(!n.success)throw new Error(n.error||"Deployment failed");v.textContent="âœ… Deployed successfully!",v.style.color="#1EB13A",window.open(n.url,"_blank"),console.log("Deployment successful:",n),alert(`Site deployed successfully!

Live URL: ${n.url}

Opening in new tab...`)}catch(t){console.error("Deployment error:",t),v.textContent=`âŒ ${t.message}`,v.style.color="#E32D2D",alert(`Deployment failed: ${t.message}`)}finally{h.disabled=!1,h.textContent="ðŸš€ Deploy to Netlify"}}const ze=localStorage.getItem("netlifyToken")||"nfp_hTepyurcDd2DRXTYM6yi8zBxpBc6Bw5Ccd72";x.value=ze;x.addEventListener("change",()=>{const e=x.value.trim();e&&localStorage.setItem("netlifyToken",e)});const Ue=localStorage.getItem(X)||"dark";oe(Ue);
